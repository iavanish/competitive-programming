<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>An array A is considered to be smaller than an array B (denoted A &lt; B) if each element of A is strictly smaller than all the elements of B.
</p>
<p>An array A can be decomposed into subarrays A1, A2, ... Ak, if and only if A = A1 + A2 + ... + Ak and A1 &lt; A2 &lt; …. &lt; Ak. In words, the original array is the concatenation of the pieces (without any reordering) and each piece is smaller than the next one.</p>
<p>Let's define fun value f(A) of an array A as : f(A) = maximum number of subarrays that the array A can be decomposed into. Given an array S of length N, you need to find the sum of f(B), where B are all the possible suffixes of the given array S. In other words, given an array S, you need to find f(S[0..n - 1]) + f(S[1..n - 1]) + ….. f(S[n - 1..n - 1]). </p>   
<p>You are given integers A0, X, Y, B0, X1, Y1, N and an integer array P. Use the pseudocode below to generate the array S.</p>
<tt>A[0] = A0<br></br>
for i = 1 to N-1:<br></br>
&#009;A[i] = (A[i-1] * X + Y) modulo 1812447359<br></br>
<br></br>
B[0] = B0<br></br>
for i = 1 to N-1:<br></br>
&#009;B[i] = (B[i-1] * X1 + Y1) modulo 1812447359<br></br>
<br></br>
S = P<br></br>
for i = size(P) to N-1:<br></br>
&#009;S[i] = max(A[i], B[i])</tt></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>SuffixDecomposition</td></tr><tr><td>Method:</td><td>findTotalFun</td></tr><tr><td>Parameters:</td><td>int[], int, int, int, int, int, int, int</td></tr><tr><td>Returns:</td><td>long</td></tr><tr><td>Method signature:</td><td>long findTotalFun(int[] P, int A0, int X, int Y, int B0, int X1, int Y1, int N)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>The length of P will be between 0 and min(N, 100) (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>Integers in P will be between 0 and 1812447358 (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>A0 will be between 0 and 1812447358 (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>X will be between 0 and 1812447358 (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>Y will be between 0 and 1812447358 (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>B0 will be between 0 and 1812447358 (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>X1 will be between 0 and 1812447358 (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>Y1 will be between 0 and 1812447358 (inclusive)</td></tr><tr><td align="center" valign="top">-</td><td>N will be between 1 and 200,000 (inclusive)</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{3, 9, 5}</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>3</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2">Here, there are three possible suffixes {5}, {9, 5}, {3, 9, 5}. Now, f({5}) = 1, f({9,5}) = 1 (as it cannot be decomposed into more than one subarrays), f({3, 9, 5}) = 2 (the two-subarray decomposition will be {3}, {9, 5}). Hence, the total fun value is 1 + 1 + 2 = 4.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{10}</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>4</pre></td></tr></table></td></tr><tr><td><pre>Returns: 8</pre></td></tr><tr><td><table><tr><td colspan="2">Here, the array is {10, 5, 10, 22}. There are four possible suffixes : {22}, {10, 22}, {5, 10, 22}, {10, 5, 10, 22}. f({22}) = 1, f({10, 22}) = 2, f({5, 10, 22}) = 3, f({10, 5, 10, 22}) = 2. Hence, total fun = 1 + 2 + 3 + 2 = 8.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{}</pre></td></tr><tr><td><pre>1000001</pre></td></tr><tr><td><pre>1000001</pre></td></tr><tr><td><pre>1000001</pre></td></tr><tr><td><pre>5000001</pre></td></tr><tr><td><pre>5000001</pre></td></tr><tr><td><pre>5000001</pre></td></tr><tr><td><pre>4</pre></td></tr></table></td></tr><tr><td><pre>Returns: 6</pre></td></tr><tr><td><table><tr><td colspan="2">Here, the array is {5000001, 1344505193, 919789863, 999879289}. f({5000001, 1344505193, 919789863, 999879289}) = 2, f({1344505193, 919789863, 999879289}) = 1, f({919789863, 999879289}) = 2, f({999879289}) = 1. Hence, total fun value = 2 + 1 + 2 + 1 = 6.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{}</pre></td></tr><tr><td><pre>1812447358</pre></td></tr><tr><td><pre>1812447358</pre></td></tr><tr><td><pre>1812447358</pre></td></tr><tr><td><pre>42524</pre></td></tr><tr><td><pre>2565262</pre></td></tr><tr><td><pre>2676642</pre></td></tr><tr><td><pre>6</pre></td></tr></table></td></tr><tr><td><pre>Returns: 7</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{}</pre></td></tr><tr><td><pre>1010</pre></td></tr><tr><td><pre>2010</pre></td></tr><tr><td><pre>3010</pre></td></tr><tr><td><pre>900010</pre></td></tr><tr><td><pre>9000</pre></td></tr><tr><td><pre>76540</pre></td></tr><tr><td><pre>8</pre></td></tr></table></td></tr><tr><td><pre>Returns: 10</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>